系统架构设计

针对原有的查询功能痛点：查询效率低，船舶产品无法关联查询，复杂条件查询不友好不灵活，我们对整体数据的存储，查询界面操作交互，底层数据查询的逻辑进行了重新设计

数据存储方面，从 ES 改为使用 clickhouse

clickhouse 是一个列式存储的数据库，适合海量数据的存储，查询效率高，我们将原有的数据从 ES 中导入到 clickhouse 中，关联 mysql 业务库中数据，同时对数据进行了清洗加工。

数据处理方面
标签表的处理方式，将整个检索中的用到的数据加工成 3 个标签表

- 船舶标签表
- 产品通用属性标签表
- 产品属性标签纵表

标签加工时将不同数据源的数据统一同步到大数据平台的 hive 中加工计算，然后将加工好的标签表同步到 clickhouse 中，供查询使用

查询界面交互方面

- 对原有的查询界面进行了重新设计，原有查询的查询条件都是输入框，新设计的界面去掉了大部分输入框，减少用户输入，提高用户的查询效率
- 保留的主要查询输入框，可支持输入一码通编号/船舶登记号/船舶中英文名称/IMO 号/产品编号/产品名称/证书编号等多项条件综合查询，
- 其他的常用查询条件使用了展开 top 选项+下拉更多选项的交互方式，并且每次查询之后，查询条件的选项根据查询结果，重新排序渲染出条件选项和结果数量，大大减少了用户的操作步骤，提高了用户的查询效率
- 使用频率不高的查询条件，使用了下拉新增查询条件的交互，保证了界面的简洁性，同时又保证了查询条件的灵活性，对于不同数据类型的查询条件，自动渲染不同的操作方式，比如数值型条件，使用范围类型输入框，日期类型条件使用日期范围输入，枚举类型使用下拉列表输入，并且枚举值是实时自动从数据库中获取最新的枚举值，不需要手工配置
- 针对常用产品分类条件，支持普通的树形选择，也支持配置化的常用产品分类列表选择，用户可以根据自己的需求，将常用的产品分类配置到列表中，方便快捷的选择
- 产品分类的查询条件联动，由于船舶产品业务的特殊性，不同类型的产品属性差异较大，对于不同的产品分类，选择产品分类后，查询条件会自动联动展示该分类产品的独特属性，以提供筛选过滤
- 对于查询的每个条件，都支持快捷的清除操作，方便用户快速的清除某个条件，重新查询
- 对于查询结果，船舶和产品都使用了卡片和列表两种展示方式，方便不同习惯的用户选择
- 查询结果中的常用字段，设置了快捷查询的操作，例如在查询结果中，点击某个造船厂，可以快速的在原有的查询条件中，新增造船厂的查询条件，方便用户快速的进行筛选
- 查询结果中的某些字段支持再次查询，如产品零部件数量，对于有零部件的产品，点击零部件数量，可以快速的查询到该产品的所有零部件产品
- 查询结果增加了可视化的产品分析功能，可对查询结果直接进行各个维度和指标的组合分析，方便用户快速得出分析结论
